"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.reducer=reducer;exports.selectors=void 0;var _get2=_interopRequireDefault(require("lodash/fp/get"));var _set2=_interopRequireDefault(require("lodash/fp/set"));var actions=_interopRequireWildcard(require("./actions"));var _persistenceHelpers=require("./persistenceHelpers");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj["default"]=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}var DEFAULT_USER_TYPE="user";function getInitialState(){return(0,_persistenceHelpers.loadSessionState)()}function reducer(state,action){var _handlers;if(state===undefined)return getInitialState();var handlers=(_handlers={},_defineProperty(_handlers,actions.setToken,function(state,_ref){var _ref$payload=_ref.payload,token=_ref$payload.token,_ref$payload$userType=_ref$payload.userType,userType=_ref$payload$userType===void 0?DEFAULT_USER_TYPE:_ref$payload$userType,_ref$payload$persist=_ref$payload.persist,persist=_ref$payload$persist===void 0?true:_ref$payload$persist;return(0,_set2["default"])(userType,{token:token,persist:persist},state)}),_defineProperty(_handlers,actions.clearToken,function(state,_ref2){var _ref2$payload=_ref2.payload;_ref2$payload=_ref2$payload===void 0?{}:_ref2$payload;var _ref2$payload$userTyp=_ref2$payload.userType,userType=_ref2$payload$userTyp===void 0?DEFAULT_USER_TYPE:_ref2$payload$userTyp;return(0,_set2["default"])(userType,{token:null,persist:false},state)}),_handlers);var handler=handlers[action.type];return handler?handler(state,action):state}var selectors={};exports.selectors=selectors;selectors.token=function(state){var _ref3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref3$userType=_ref3.userType,userType=_ref3$userType===void 0?DEFAULT_USER_TYPE:_ref3$userType;if(!(0,_get2["default"])("sessions",state))throw new Error("redux-sessions: state not found. Did you remember to attach the reducer at key `sessions`?");return(0,_get2["default"])("sessions."+userType+".token",state)};selectors.isAuthenticated=function(state,options){return!!selectors.token(state,options)};selectors.isUnauthenticated=function(state,options){return!selectors.isAuthenticated(state,options)};